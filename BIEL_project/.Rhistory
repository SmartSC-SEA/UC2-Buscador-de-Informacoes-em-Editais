library(bigrquery)
library(rvest)
library(tidyverse)
library(janitor)
library(xml2)
library(stringr)
################################################################################
#### captura os parâmetros para compor as URLs de acesso aos repositórios dos editais
#### respositórios contidos nas primeiras 10 páginas
options(warn = -1)
link_base <- 'https://sistemas4.sc.gov.br/sea/portaldecompras/acompanha_licitacao_edital.asp?lstOrgaos=1&optNatureza=&lstAno=2022&lstSituacao=4&txtNuEdital=&lstModalidade=0&txtObjeto=&dataInclusao=&descricaoGrupoClasse=&paginaAtual='
i <- 1
link <- paste0(link_base,i)
base_parametros_final <- data.frame()
while (length(try(busca_parametros <- as.data.frame(read_html(link) %>% html_nodes("img") %>% html_attr("onclick"))) >= 1)) {
print(paste0('Capturando Parâmetros da Página ', i))
#try(busca_parametros <- as.data.frame(read_html(link) %>% html_nodes("img") %>% html_attr("onclick")))
base_parametros_final <- bind_rows(base_parametros_final, busca_parametros)
#Sys.sleep(time = 15)
i <- i + 1
link <- paste0(link_base,i)
}
